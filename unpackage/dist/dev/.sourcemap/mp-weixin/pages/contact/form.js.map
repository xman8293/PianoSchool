{"version":3,"file":"form.js","sources":["pages/contact/form.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29udGFjdC9mb3JtLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"form-container\">\r\n    <!-- 机构Logo -->\r\n    <image \r\n      src=\"/static/logo.png\" \r\n      mode=\"aspectFit\" \r\n      class=\"header-logo\"\r\n    />\r\n\r\n    <view class=\"form-card\">\r\n      <!-- 表单标题 -->\r\n      <view class=\"form-header\">\r\n        <text class=\"title\">课程咨询</text>\r\n        <text class=\"subtitle\">专业音乐教育·成就艺术梦想</text>\r\n      </view>\r\n\r\n      <!-- 表单内容 -->\r\n      <view class=\"form-body\">\r\n        <!-- 姓名 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"label\">家长姓名</text>\r\n          <input \r\n            v-model=\"formData.name\"\r\n            placeholder=\"请输入姓名\"\r\n            class=\"input\"\r\n            :class=\"{ error: errors.name }\"\r\n          />\r\n          <text v-if=\"errors.name\" class=\"error-msg\">{{ errors.name }}</text>\r\n        </view>\r\n\r\n        <!-- 手机号 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"label\">联系电话</text>\r\n          <input\r\n            v-model=\"formData.phone\"\r\n            placeholder=\"请输入手机号\"\r\n            type=\"number\"\r\n            maxlength=\"11\"\r\n            class=\"input\"\r\n            :class=\"{ error: errors.phone }\"\r\n          />\r\n          <text v-if=\"errors.phone\" class=\"error-msg\">{{ errors.phone }}</text>\r\n        </view>\r\n\r\n        <!-- 孩子年龄 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"label\">孩子年龄</text>\r\n          <input\r\n            v-model=\"formData.age\"\r\n            placeholder=\"请输入年龄\"\r\n            type=\"number\"\r\n            class=\"input\"\r\n            :class=\"{ error: errors.age }\"\r\n          />\r\n          <text v-if=\"errors.age\" class=\"error-msg\">{{ errors.age }}</text>\r\n        </view>\r\n\r\n        <!-- 兴趣科目 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"label\">兴趣科目</text>\r\n          <picker\r\n            mode=\"selector\"\r\n            :range=\"subjectOptions\"\r\n            @change=\"onSubjectChange\"\r\n          >\r\n            <view class=\"picker\" :class=\"{ placeholder: !formData.subject }\">\r\n              {{ formData.subject || '请选择兴趣科目' }}\r\n            </view>\r\n          </picker>\r\n        </view>\r\n\r\n        <!-- 提交按钮 -->\r\n        <button \r\n          class=\"submit-btn\" \r\n          :disabled=\"isSubmitting\"\r\n          @click=\"handleSubmit\"\r\n        >\r\n          {{ isSubmitting ? '提交中...' : '立即预约' }}\r\n        </button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\n\r\n// 表单数据\r\nconst formData = ref({\r\n  name: '',\r\n  phone: '',\r\n  age: '',\r\n  subject: ''\r\n})\r\n\r\n// 验证错误信息\r\nconst errors = ref({\r\n  name: '',\r\n  phone: '',\r\n  age: ''\r\n})\r\n\r\n// 表单提交状态\r\nconst isSubmitting = ref(false)\r\n\r\n// 科目选项\r\nconst subjectOptions = ref(['钢琴', '古筝', '小提琴', '吉他', '声乐', '其他'])\r\n\r\n// 选择科目\r\nconst onSubjectChange = (e) => {\r\n  const index = e.detail.value\r\n  formData.value.subject = subjectOptions.value[index]\r\n}\r\n\r\n// 表单验证规则\r\nconst validateForm = () => {\r\n  let isValid = true\r\n  const newErrors = { name: '', phone: '', age: '' }\r\n\r\n  if (!formData.value.name.trim()) {\r\n    newErrors.name = '姓名不能为空'\r\n    isValid = false\r\n  }\r\n\r\n  if (!/^1[3-9]\\d{9}$/.test(formData.value.phone)) {\r\n    newErrors.phone = '请输入有效的手机号'\r\n    isValid = false\r\n  }\r\n\r\n  if (!formData.value.age || formData.value.age < 3 || formData.value.age > 18) {\r\n    newErrors.age = '请输入3-18岁的有效年龄'\r\n    isValid = false\r\n  }\r\n\r\n  errors.value = newErrors\r\n  return isValid\r\n}\r\n\r\n// 提交表单\r\nconst handleSubmit = async () => {\r\n  if (!validateForm()) return\r\n\r\n  isSubmitting.value = true\r\n\r\n  try {\r\n    const res = await uniCloud.callFunction({\r\n      name: 'submitFeedback',\r\n      data: {\r\n        ...formData.value,\r\n        createTime: Date.now()\r\n      }\r\n    })\r\n\r\n    if (res.result.code === 200) {\r\n      uni.showConfirm({\r\n        title: '提交成功',\r\n        content: '感谢您的咨询,我们会尽快与您联系',\r\n        success: function (res) {\r\n          if (res.confirm) {\r\n            uni.navigateBack()\r\n          }\r\n        }\r\n      })\r\n      // 清空表单\r\n      formData.value = { name: '', phone: '', age: '', subject: '' }\r\n    } else {\r\n      throw new Error(res.result.msg)\r\n    }\r\n  } catch (e) {\r\n    console.error('提交失败:', e)\r\n    uni.showToast({ title: '提交失败，请重试', icon: 'none' })\r\n  } finally {\r\n    isSubmitting.value = false\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.form-container {\r\n  padding: 30rpx;\r\n  background: #f5f7fa;\r\n  min-height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.header-logo {\r\n  width: 320rpx;\r\n  height: 120rpx;\r\n  margin: 40rpx 0;\r\n}\r\n\r\n.form-card {\r\n  background: #fff;\r\n  border-radius: 24rpx;\r\n  padding: 40rpx;\r\n  box-shadow: 0 4rpx 20rpx rgba(0,0,0,0.05);\r\n  width: 100%;\r\n  max-width: 700rpx;\r\n}\r\n\r\n.form-header {\r\n  margin-bottom: 40rpx;\r\n  text-align: center;\r\n}\r\n\r\n.title {\r\n  font-size: 40rpx;\r\n  font-weight: 600;\r\n  color: #2A3F54;\r\n  display: block;\r\n  margin-bottom: 10rpx;\r\n  letter-spacing: 2rpx;\r\n}\r\n\r\n.subtitle {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  font-weight: 500;\r\n}\r\n\r\n.form-item {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.label {\r\n  display: block;\r\n  font-size: 30rpx;\r\n  color: #2A3F54;\r\n  margin-bottom: 15rpx;\r\n}\r\n\r\n.input {\r\n  width: 100%;\r\n  height: 80rpx;\r\n  padding: 0 20rpx;\r\n  border: 2rpx solid #eee;\r\n  border-radius: 12rpx;\r\n  font-size: 28rpx;\r\n}\r\n\r\n.input.error {\r\n  border-color: #ff4d4f;\r\n}\r\n\r\n.error-msg {\r\n  color: #ff4d4f;\r\n  font-size: 24rpx;\r\n  margin-top: 10rpx;\r\n  display: block;\r\n}\r\n\r\n.picker {\r\n  height: 80rpx;\r\n  line-height: 80rpx;\r\n  padding: 0 20rpx;\r\n  border: 2rpx solid #eee;\r\n  border-radius: 12rpx;\r\n  color: #333;\r\n}\r\n\r\n.placeholder {\r\n  color: #999;\r\n}\r\n\r\n.submit-btn {\r\n  margin-top: 50rpx;\r\n  background: linear-gradient(135deg, #2A3F54, #3A5F7A);\r\n  color: #fff;\r\n  height: 90rpx;\r\n  line-height: 90rpx;\r\n  border-radius: 12rpx;\r\n  font-size: 32rpx;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.submit-btn:active {\r\n  transform: scale(0.98);\r\n  opacity: 0.9;\r\n}\r\n</style> ","import MiniProgramPage from 'E:/MyProject/PianoSchool/pages/contact/form.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uniCloud","uni","res"],"mappings":";;;;;;AAwFA,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACnB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,MACL,SAAS;AAAA,IACX,CAAC;AAGD,UAAM,SAASA,cAAAA,IAAI;AAAA,MACjB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,IACP,CAAC;AAGD,UAAM,eAAeA,cAAG,IAAC,KAAK;AAG9B,UAAM,iBAAiBA,cAAAA,IAAI,CAAC,MAAM,MAAM,OAAO,MAAM,MAAM,IAAI,CAAC;AAGhE,UAAM,kBAAkB,CAAC,MAAM;AAC7B,YAAM,QAAQ,EAAE,OAAO;AACvB,eAAS,MAAM,UAAU,eAAe,MAAM,KAAK;AAAA,IACrD;AAGA,UAAM,eAAe,MAAM;AACzB,UAAI,UAAU;AACd,YAAM,YAAY,EAAE,MAAM,IAAI,OAAO,IAAI,KAAK,GAAI;AAElD,UAAI,CAAC,SAAS,MAAM,KAAK,KAAI,GAAI;AAC/B,kBAAU,OAAO;AACjB,kBAAU;AAAA,MACX;AAED,UAAI,CAAC,gBAAgB,KAAK,SAAS,MAAM,KAAK,GAAG;AAC/C,kBAAU,QAAQ;AAClB,kBAAU;AAAA,MACX;AAED,UAAI,CAAC,SAAS,MAAM,OAAO,SAAS,MAAM,MAAM,KAAK,SAAS,MAAM,MAAM,IAAI;AAC5E,kBAAU,MAAM;AAChB,kBAAU;AAAA,MACX;AAED,aAAO,QAAQ;AACf,aAAO;AAAA,IACT;AAGA,UAAM,eAAe,YAAY;AAC/B,UAAI,CAAC,aAAY;AAAI;AAErB,mBAAa,QAAQ;AAErB,UAAI;AACF,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACtC,MAAM;AAAA,UACN,MAAM;AAAA,YACJ,GAAG,SAAS;AAAA,YACZ,YAAY,KAAK,IAAK;AAAA,UACvB;AAAA,QACP,CAAK;AAED,YAAI,IAAI,OAAO,SAAS,KAAK;AAC3BC,wBAAAA,MAAI,YAAY;AAAA,YACd,OAAO;AAAA,YACP,SAAS;AAAA,YACT,SAAS,SAAUC,MAAK;AACtB,kBAAIA,KAAI,SAAS;AACfD,8BAAAA,MAAI,aAAc;AAAA,cACnB;AAAA,YACF;AAAA,UACT,CAAO;AAED,mBAAS,QAAQ,EAAE,MAAM,IAAI,OAAO,IAAI,KAAK,IAAI,SAAS,GAAI;AAAA,QACpE,OAAW;AACL,gBAAM,IAAI,MAAM,IAAI,OAAO,GAAG;AAAA,QAC/B;AAAA,MACF,SAAQ,GAAG;AACVA,sBAAAA,MAAA,MAAA,SAAA,iCAAc,SAAS,CAAC;AACxBA,sBAAG,MAAC,UAAU,EAAE,OAAO,YAAY,MAAM,QAAQ;AAAA,MACrD,UAAY;AACR,qBAAa,QAAQ;AAAA,MACtB;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7KA,GAAG,WAAW,eAAe;"}